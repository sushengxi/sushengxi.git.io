<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="中文，英文">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/sushengxi.git.io/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/sushengxi.git.io/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/sushengxi.git.io/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/sushengxi.git.io/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/sushengxi.git.io/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/sushengxi.git.io/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/sushengxi.git.io/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="h5，javascript,css,node,java,mysql,mongodb">
<meta property="og:type" content="website">
<meta property="og:title" content="little su的博客">
<meta property="og:url" content="https://github.com/sushengxi/sushengxi.git.io.git/index.html">
<meta property="og:site_name" content="little su的博客">
<meta property="og:description" content="h5，javascript,css,node,java,mysql,mongodb">
<meta property="og:locale" content="中文，英文">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="little su的博客">
<meta name="twitter:description" content="h5，javascript,css,node,java,mysql,mongodb">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/sushengxi.git.io/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://github.com/sushengxi/sushengxi.git.io.git/">





  <title>little su的博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="中文，英文">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/sushengxi.git.io/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">little su的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">开发中遇到的问题及一些知识的梳理</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/sushengxi.git.io/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/sushengxi.git.io/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2018/10/23/javascript数据结构-栈/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2018/10/23/javascript数据结构-栈/" itemprop="url">javascript数据结构==>栈</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-10-23T15:54:54+08:00">
                2018-10-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##javascript数据结构==栈<br>&ensp;&ensp;javascript数据结构==栈<br>&ensp;&ensp;栈，又叫堆栈，是和列表类似的一种数据结构，但是却更高效，因为栈内的元素只能通过列表的一端访问，称为栈顶，数据只能&ensp;&ensp;在栈顶添加或删除，遵循 先入后出(LIFO，last-in-first-out) 的原则。<br>&ensp;&ensp;对栈的操作主要有两种，一是将一个元素压入栈，push方法，另一个就是将栈顶元素出栈，pop方法。除此之外，栈还有其他的&ensp;&ensp;一些属性和方法：查看当前栈顶的元素值，我们使用 peek 方法，它仅仅返回栈顶元素值，并不删除它；clear 方法用于清空当&ensp;&ensp;前栈内的所有元素；top属性记录当前栈顶位置；length方法返回当前栈内元素总数等；接着我们定义栈的数据类型，并利用JS&ensp;&ensp;中的数组去实现它。<br>&ensp;&ensp;下面是栈的实现<br>&ensp;&ensp;我们利用 dataStore 来保存栈内元素，初始化为空数组，top 属性用于记录当前栈顶位置，初始化的时候为0，<br>&ensp;&ensp;表示栈顶对应数组的起始位置是0，如果有元素入栈，则该属性会随之反生变化。<br>&ensp;&ensp;栈的方法:<br>&ensp;&ensp;push向栈内压入一个元素<br>&ensp;&ensp;pop像栈取出一个元素<br>&ensp;&ensp;peek查看栈顶元素<br>&ensp;&ensp;length：返回栈内元素总数<br>&ensp;&ensp;clear：清空栈<br>&ensp;&ensp;具体实现得代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">function Stack() &#123;</span><br><span class="line">  this.dataStore = [];//初始化为空</span><br><span class="line">  this.top = 0; //记录栈顶位置</span><br><span class="line">  this.pop = pop;//出栈</span><br><span class="line">  this.push = push;//入栈</span><br><span class="line">  this.peek = peek;//查看栈顶元素</span><br><span class="line">  this.length = length;//查看栈内元素总数</span><br><span class="line">  this.clear = clear;//清空栈</span><br><span class="line">&#125;</span><br><span class="line">//入栈</span><br><span class="line">function push(ele) &#123;</span><br><span class="line">this.dataStore[this.top++] = ele;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//出栈</span><br><span class="line">function pop() &#123;</span><br><span class="line">  return this.dataStore[--this.top];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//查看栈顶的元素</span><br><span class="line">function peek() &#123;</span><br><span class="line">if(this.top &gt;0) &#123;</span><br><span class="line">  return this.dataStore[this.top];</span><br><span class="line">&#125; else &#123;</span><br><span class="line">  return -1;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">//查看栈里面元素的数量</span><br><span class="line">function length() &#123;</span><br><span class="line">   return this.top;</span><br><span class="line">&#125;</span><br><span class="line">//清空栈</span><br><span class="line">function clear() &#123; </span><br><span class="line">   delete this.dataStore;</span><br><span class="line">   this.dataStore = [];</span><br><span class="line">   this.top = 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2018/01/30/Nodejs-app-use的使用/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2018/01/30/Nodejs-app-use的使用/" itemprop="url">Nodejs app.use的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-30T15:22:30+08:00">
                2018-01-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Nodejs中间件<br>&ensp;&ensp;app.use([path,] function [, function…])<br>&ensp;&ensp;在path上安装中间件，如果path没有被设定，那么默认为”/”。<br>&ensp;&ensp;当为路由设置一个匹配路径后，路由会匹配该路径及该路径下所有的路径。例如：<br>&ensp;&ensp;app.use(‘/apple’, …)会匹配请求路径’/apple’, ‘/apple/images’,<br>&ensp;&ensp;‘/apple/images/news’等。<br>&ensp;&ensp;在中间件中req.originalUrl是req.baseUrl和req.path的组合，如下面的例子所示：</p>
<hr>
<p><img src="usezjj1.png" alt="mongodb"></p>
<hr>
<p>&ensp;&ensp;在path路径上安装中间件，每当请求的路径的基路径和该path匹配时，都会导致该中间件函数被执行。例如，默认路径’/’，即&ensp;&ensp;当中间件没有设置安装路径时，任何向该应用的请求都会触发该中间件函数.如果设置了基路径则会进入基路径对应的router如&ensp;&ensp;下列 基路径”/openapi” 会进入baseRouter路由下面</p>
<hr>
<p><img src="router.png" alt="mongodb"></p>
<hr>
<p>路径可以是一个字符也可以是一个模式一个正则表达式来表示或者他们的组合形式。例如：</p>
<hr>
<p><img src="path.png" alt="mongodb"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2018/01/22/Nodejs-log4js的使用/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2018/01/22/Nodejs-log4js的使用/" itemprop="url">Nodejs log4js的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-22T15:05:59+08:00">
                2018-01-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#Nodejs中间件<br>&ensp;&ensp;一.log4js的使用非常简单:<br>&ensp;&ensp;&ensp;&ensp;1.安装包(npm install log4js)<br>&ensp;&ensp;&ensp;&ensp;2.创建日志目录(./logs/log_fie/)<br>&ensp;&ensp;&ensp;&ensp;3.添加一个日志输出规则的配置文件(log4js.json)(这个也是有缺省的,但往往缺省配置是不满足使用需求的)<br>&ensp;&ensp;&ensp;&ensp;4.代码中加载log4js,并将配置文件获取到调用一下配置方法(log4js.configure(cfg.json))<br>&ensp;&ensp;&ensp;&ensp;5.写日志log4js.getLogger(‘log_test’).debug(“随便写日志啦!!!”)<br>&ensp;&ensp;二.Log4js的配置详解<br>&ensp;&ensp;1.appenders属性<br>&ensp;&ensp;appenders是配置文件的一级属性:它的作用是配置输出源.后续我们真正输出日志的对象就是appenders的下属子项标注的输出&ensp;&ensp;源appenders的子属性.<br>&ensp;&ensp;1.1 category配置<br>&ensp;&ensp;category翻译过来叫做种类.实际上更简单的理解成这个写日志员工的名字.<br>&ensp;&ensp;当我们有多个员工时就依靠与这个字段来区分,前面例子中,写日志前有这样一行code:<br>&ensp;&ensp;log4js.getLogger(‘log_file’).debug(…);<br>&ensp;&ensp;这个getLogger()的参数就是category的配置内容,可以是任意字符串<br>&ensp;&ensp;1.2 type配置<br>&ensp;&ensp;type字段是控制日志输出对象的是什么类型的,比较常用的配置有三个:<br>&ensp;&ensp;&ensp;&ensp;a.”type”:”console”:<br>&ensp;&ensp;&ensp;&ensp;type配置为console表示控制台,在此种配置下,往往用于调试时.细节参见2.replaceConsole中的描述.<br>&ensp;&ensp;b.”type”:”file”:<br>&ensp;&ensp;&ensp;&ensp;type配置为file表示日志输出为普通文件,在此种配置下,日志会输出到目标文件夹的目标文件中,并会随着文件大小的变化自动份文件.<br>&ensp;&ensp; 该模式下的具体生成文件方法:<br>&ensp;&ensp;相关有效配置包含:maxLogSize,backups,filename<br>&ensp;&ensp;相关无效配置包含:pattern,alwaysIncludePattern<br>&ensp;&ensp;c.”type”:”datefile”<br>&ensp;&ensp;type配置为datefile表示是输出按时间分文件的日志,在此种配置下,日志会输出到目标目录下,并以时间格式命名,随着时间的&ensp;&ensp;推移,以时间格式命名的文件如果尚未存在,则自         动创建新的文件.<br>&ensp;&ensp;该模式下的具体生成文件方法:<br>&ensp;&ensp;相关有效配置包含:pattern,alwaysIncludePattern,filename<br>&ensp;&ensp;相关无效配置包含:maxLogSize,backups<br>&ensp;&ensp;1.3 filename配置<br>&ensp;&ensp;a.filename是一个目录加上文件名,路径就是日志文件存储的路径.<br>&ensp;&ensp; b.此路径可以是相对路径也可以绝对路径,当是相对路径时,是相对于工程根目录.<br>&ensp;&ensp;c.无论是相对路径还是绝对路径,路径过程中的所有文件夹必须事先手动创建好,log4js不会自动创建,如路径不存在则会报错.<br>&ensp;&ensp;d.最后的文件名就是输出文件的名字模版,真实的名字会一定的修改,<br>&ensp;&ensp;&ensp;&ensp;d1:type:datefile 时会加上时间标签,如 [log-2015-01-24 , log-2015-01-25]<br>&ensp;&ensp;&ensp;&ensp;d2:type:file时 如果文件过大,份文件后会增加一个编号标签. [log.1 log.2 log.3 …]<br>&ensp;&ensp;1.4 maxLogSize配置<br>&ensp;&ensp;这个只在type:file模式有效.表示文件多大时才会创建下一个文件,单位是字节.实际设置时具体的值根据业务来定,但是不推荐&ensp;&ensp;大于100Mb.<br>&ensp;&ensp;1.5 pattern配置<br>&ensp;&ensp;这个只在type:datefile模式有效.表示一个文件的时间命名模式.在生成文件中会依照pattern配置来在filename的文件结尾&ensp;&ensp;追加一个时间串来命名文件.上个例子:<br>&ensp;&ensp;&ensp;&ensp;配置文件内容:<br>&ensp;&ensp;&ensp;&ensp;{<br>&ensp;&ensp;&ensp;&ensp;”category”:”log_date”,<br>&ensp;&ensp;&ensp;&ensp;”type”: “dateFile”,<br>&ensp;&ensp;&ensp;&ensp;”filename”: “./logs/log_date/date”,<br>&ensp;&ensp;&ensp;&ensp;”alwaysIncludePattern”: true,<br>&ensp;&ensp;&ensp;&ensp;”pattern”: “-yyyy-MM-dd-hh:mm:ss.log”<br>&ensp;&ensp;&ensp;&ensp;}<br>&ensp;&ensp;此时生成的文件名就是date-2015-01-24-14:24:12.log<br>&ensp;&ensp;pattern精确到ss(秒)就是一秒一个文件,精确到mm(分)就是一分一个文件,一次类推:hh(小<br>&ensp;&ensp;时),dd(天),MM(月),yyyy(年),yy(年后两位),注意大小写!<br>&ensp;&ensp;pattern是有默认配置的,默认配置是”.yyyy-MM-dd”<br>&ensp;&ensp;1.6 alwaysIncludePattern:<br>&ensp;&ensp;这个只在type:datefile模式有效.<br>&ensp;&ensp;这个是个开关配置 ture(默认值)是开启pattern,false是不开启pattern,不开启时datefile文件将无任何时间后缀,也不会&ensp;&ensp;分文件.<br>&ensp;&ensp;1.7 backups配置<br>&ensp;&ensp;这个只在type:file模式有效,表示备份的文件数量,如果文件过多则会将最旧的删除.<br>&ensp;&ensp;type:file模式下log4js的命名规则:正在写的文件就叫filename中配置的文件名,文件过大后会追加数字 例如 log.1 log.2 &ensp;&ensp;log.3 , 直至文件数量达到backups时会把最旧的删除.<br>&ensp;&ensp;当创建一个新的文件时,log4js会把所有之前的文件的.数字编号都顺延一位,最后将刚刚出现的大文件后面追加.1; 这种模式下&ensp;&ensp;应该注意大文件拷贝时对命名的影响,所以maxLogSize不要设置过大.<br>&ensp;&ensp;2.replaceConsole配置<br>&ensp;&ensp;这个配置是表示是否替换控制台输出.当配置文件中配置了appenders中配置了type:console的员工,并且&ensp;&ensp;replaceConsole:true时,代码中控制台输出(console.log  console.error)的内容将会以log4js格式输出到控制台中.<br>&ensp;&ensp;再说一个很实用的小技巧:log4js的时时调试输出:<br>&ensp;&ensp;当我们把实际生产环境的log4js.json配置好后,在调试阶段,日志会输出到各个文件中,试试调试起来很不方便,那么我们可以将各个日志输出员工的type配置为console,这样日志信息就会全都汇总到控制台输出.<br>&ensp;&ensp;此时如果再添加一个如下日志员工配置,则代码中nodejs系统提供的console.log也会输出到控制台中.<br>&ensp;&ensp;{<br>&ensp;&ensp;&ensp;&ensp;”type”:”console”,<br>&ensp;&ensp;&ensp;&ensp;”category”:”console”<br>&ensp;&ensp;}<br>&ensp;&ensp;其中category的名字必须叫console,否则无效,<br>&ensp;&ensp;replaceConsole:ture时如果不加这行,nodejs系统提供的console.log()输出的内容将不会显示<br>&ensp;&ensp;3.levels配置<br>&ensp;&ensp;levels配置也是一个一级属性,它控制着日志的输出级别.在发布的程序,如果很稳定,一些不重要的日志是需要隐去的,但当调试阶段或者环境异常时我们需要重现所有流程,就需要全面的日志.<br>&ensp;&ensp;levels的结构中配置着若干个属性,一般与appenders中的员工对应,其中属性名是appenders中的员工名(也就是category的值),属性值是一个表示等级的字符串.<br>&ensp;&ensp;log4js的levels配置共分为8个等级(也就是日志等级),由低到高分别为:ALL TRACE DEBUG INFO WARN ERROR FATAL OFF.<br>&ensp;&ensp;只有大于等于日志配置级别的信息才能输出出来.<br>&ensp;&ensp;三.Log4js的常见问题和小技巧<br>&ensp;&ensp;配置文件的格式设定<br>&ensp;&ensp;配置文件其实就是一个js对象,json,js,或者自己通过各种set方法赋值出来一个都一样<br>&ensp;&ensp;最开始说需要将配置文件与配置文件log4js.json与log4js模块关联,也就是调用configure()函数加载配置,其实此时就是需&ensp;&ensp;要一个JavaScript对象而已,既然如此,我们完全可以把配置文件写成js格式的文件,类似于这样的:<br>&ensp;&ensp;module.exports = { … 这里面的内容就是上面贴的json啦};<br>&ensp;&ensp;这种模型的优势是如果配置中有动态信息,可以在配置中添加函数,比如用文件名以pid命名,在配置时可以动态获取pid然后字符&ensp;&ensp;串拼接到filename上.另一个优势是json不支持注释,写成js后可以添加注释.<br>&ensp;&ensp;下面是我在项目里面log4js的配置文件</p>
<hr>
<p><img src="log4jsconfig.png" alt="mongodb"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2018/01/20/Nodejs中间件/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2018/01/20/Nodejs中间件/" itemprop="url">Nodejs中间件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-01-20T14:57:56+08:00">
                2018-01-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##Nodejs中间件<br>&ensp;&ensp; 首先理解一下中间件的概念：<br>&ensp;&ensp;中间件：是一个函数，它可以访问请求对象（request）, 响应对象（response）, 和 web 应用中处于请求-响应循环流程中的&ensp;&ensp;中间件(next)。(来源：express官网)著作权归作者所  有。<br>&ensp;&ensp;中间件的功能包括：<br>   &ensp;&ensp;&ensp;&ensp;执行任何代码。<br>   &ensp;&ensp;&ensp;&ensp;修改请求和响应对象。<br>   &ensp;&ensp;&ensp;&ensp;终结请求-响应循环。<br>   &ensp;&ensp;&ensp;&ensp;调用堆栈中的下一个中间件<br>   &ensp;&ensp;&ensp;&ensp;简单说中间件就是在请求过程中可以修改内容<br>&ensp;&ensp;下面是中间件的使用</p>
<hr>
<p><img src="usezjj.png" alt="mongodb"></p>
<hr>
<p>当你访问localhost:3001首先会进入上面的中间件 然后这个中间件执行完成之后会调用下一个中件件 直到该请求响应结束<br>上面代码片段里面的next()<br>  其实，它表示是下一个中间件(函数)，也就是第一个的中间件(函数)中的next是第二个中间件(函数)，如果你不调用next，就不会调用下一个中间件(函数)，也就是说到此结束了。而express的逻辑是只有所有中间件都被执行了，才会执行路由，也就是说，如果上面的实例中，第二个中间件不调用next，就不会执行route路由<br>下面是一个router路由的例子</p>
<hr>
<p><img src="router.png" alt="mongodb"></p>
<hr>
<p>&ensp;&ensp;上面路由的例子中  第一参数是url 第二个参数是对应的业务逻辑</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2017/11/03/javascript异步的几种方式/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2017/11/03/javascript异步的几种方式/" itemprop="url">javascript异步的几种方式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-11-03T15:49:28+08:00">
                2017-11-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##javascript异步的几种方式<br>&ensp;&ensp;javascript中异步的几种方式<br>&ensp;&ensp;javascript语言的执行环境是”单线程”（single thread，就是指一次只能完成一件任务。如果有多个任务，就必须排队，前&ensp;&ensp;面一个任务完成，再执行后面一个任务，以此类推）。<br>&ensp;&ensp;这种模式的好处是实现起来比较简单，执行环境相对单纯；坏处是只要有一个任务耗时很长，后面的任务都必须排队等着，会拖&ensp;&ensp;延整个程序的执行。常见的浏览器无响应（假死），往往就是因为某一段Javascript代码长时间运行（比如死循环），导致整&ensp;&ensp;个页面卡在这个地方，其他任务无法执行。<br>&ensp;&ensp;为了解决这个问题，Javascript语言将任务的执行模式分成两种：同步（Synchronous）和异步（Asynchronous）。<br>&ensp;&ensp;“同步模式” 就是必须等待上一个任务完成才能进行下一个任务”异步模式”则完全不同，每一个任务有一个或多个回调函数&ensp;&ensp;（callback），前一个任务结束后，不是执行后一个任务，而是执行回调函数，后一个任务则是不等前一个任务结束就执行，&ensp;&ensp;所以程序的执行顺序与任务的排列顺序是不一致的、异步的。<br>&ensp;&ensp;“异步模式” 非常重要。在浏览器端，耗时很长的操作都应该异步执行，避免浏览器失去响应.<br>&ensp;&ensp;处理异步的集中方式<br>&ensp;&ensp;&ensp;&ensp;1.callback(回调函数)<br>&ensp;&ensp;回调是一个函数被作为一个参数传递到另一个函数里，在那个函数执行完后再执行.<br>&ensp;&ensp;举例：<br>&ensp;&ensp;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">first()</span><br><span class="line">seconed()</span><br><span class="line">senconed等待first执行完成在执行</span><br><span class="line"></span><br><span class="line">function first(callback) &#123;</span><br><span class="line">    setTimeOut(() =&gt; &#123;</span><br><span class="line">       callback() </span><br><span class="line">    &#125;,5000);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;first(seconed());<br>&ensp;&ensp;采用这种方式我们同步变成了异步，先执行程序的主要逻辑将比较好事的操作推迟执行<br>&ensp;&ensp;回调函数的优点是简单容易理解部署方便缺点是代码的耦合性太强，流程很混乱每一个函数只能有一个回调函数<br>&ensp;&ensp;这个地方有一个小细节就是回调不一定是异步他们之间没有直接的关系<br>&ensp;&ensp;举例：<br>&ensp;&ensp;同步回调<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function A(callback) &#123;</span><br><span class="line">    console.log(&quot;first&quot;);</span><br><span class="line">    callback();</span><br><span class="line">&#125;</span><br><span class="line">function B() &#123;</span><br><span class="line">    console.log(&quot;seconed&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;A(B);<br>&ensp;&ensp;异步回调:因为js是单线程的但是有很多操作执行步骤是很耗时的比如从远程获取资源（ajax)如果一直在单线程的堵塞下影响&ensp;&ensp;用户体验解决的方案就是耗时的都让异步去完成等完成了给我资源继续往下走<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var xhr = new XMLHttpRequest();</span><br><span class="line">xhr.open(&apos;POST&apos;, url, true);   //第三个参数决定是否采用异步的方式</span><br><span class="line">xhr.send(data);</span><br><span class="line">xhr.onreadystatechange = function()&#123;</span><br><span class="line">    if(xhr.readystate === 4 &amp;&amp; xhr.status === 200)&#123;</span><br><span class="line">       ///do something</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;上面这个是浏览器面发送ajax的例子<br>&ensp;&ensp;2.事件监听<br>&ensp;&ensp;事件监听采用的是事件驱动模式,事件的发生不是取决于代码的手续而是事件是否触发<br>&ensp;&ensp;监听函数有on,bind,addEventListeners,listener,observe<br>&ensp;&ensp;以first,seconed为例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">first.on(&quot;done&quot;,seconed);(jquery的写法)</span><br><span class="line">function first() &#123;</span><br><span class="line">    setTimeOut(() =&gt; &#123;</span><br><span class="line">       first.trriger(&quot;done&quot;);</span><br><span class="line">    &#125;,1000)</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;调用first()后立即触发first的done事件立即执行seconed;这种方式绑定的事件不局限于一个，而且代码的耦合性低，有利于&ensp;&ensp;模块化 而缺点是整个程序都是事件驱动类型的，运行流程会变得复杂不清楚，<br>&ensp;&ensp;1&gt;onclick方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ele.onclick = function() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;2&gt;attachEvent和addEvenListener方法<br>&ensp;&ensp;IE浏览器里面是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ele.attachEvent(&quot;onclick&quot;,handler0);</span><br><span class="line">ele.attachEvent(&quot;onclick&quot;,handler1);</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;非IE浏览器里面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ele.addEvenListener(&quot;click&quot;,hander0);</span><br><span class="line">ele.addEvenListener(&quot;click&quot;,hander1);</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;以上两种绑定方式执行的顺序 attachEvent 是从后往前 1-&gt;0 addEvenListener是从前往后 0-&gt;1,addEvenListener这个方&ensp;&ensp;法的第三个参数说明该事件是否冒泡<br>&ensp;&ensp;3&gt;发布订阅模式<br>&ensp;&ensp;什么事发布订阅模式：发布订阅模式，基于一个主题/事件通道，希望接收通知的对象（称为subscriber）通过自定义事件订阅&ensp;&ensp;主题，被激活事件的对象（称为publisher）通过发布主题事件的方式被通知。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Object.subscribe(&quot;done&quot;, f2);</span><br><span class="line">function first() &#123;</span><br><span class="line">    setTimeOut(() =&gt; &#123;</span><br><span class="line">        Object.publish(&quot;done&quot;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;取消订阅模式 Object.unsubscribe(“done”, f2)<br>&ensp;&ensp;4&gt;promise<br>&ensp;&ensp;promise是es6解决回调嵌套过深的方案（但是不止这一种）<br>    &ensp;&ensp;&ensp;&ensp;1&gt;promise是commonJS工作组提出的一种规范一种模式，目的是为了异步编程提供统一接口。<br>    &ensp;&ensp;&ensp;&ensp;2&gt;promise是一种模式，promise可以帮忙管理异步方式返回的代码。<br>    &ensp;&ensp;&ensp;&ensp;3&gt;promise完成之后，对应的代码也会执行。我们可以注册任意数量的函数再成功或者失败后运行，也可以&ensp;&ensp;在任何时候注册事件处理程序。<br>    &ensp;&ensp;4&gt;三种转态：pending/reslove/reject 。pending就是未解决，resolve可以理解为成功，reject可以理解为拒绝。<br>    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">let promise = new Promise(function(resolve,reject) &#123;</span><br><span class="line">    setTimeOut(function() &#123;</span><br><span class="line">        let result;</span><br><span class="line">        if(result) &#123;</span><br><span class="line">            resolve(result);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            reject(&quot;Error&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">promise.then(function(value) &#123;</span><br><span class="line">   //成功</span><br><span class="line">&#125;).catch(function(e) &#123;</span><br><span class="line">   //失败</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>&ensp;&ensp;这样写的优点是回调函数写成了链式写法，程序的流程可以看得很清楚，而且有一整套的配套方法，可以实现很多强大的功能但&ensp;&ensp;是也有他的缺点就是没有promise 回调函数是横向增长 而promise回调增多则纵向增长</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2017/05/23/mongodb管道/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2017/05/23/mongodb管道/" itemprop="url">mongodb管道</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-23T14:27:35+08:00">
                2017-05-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#mongodb管道<br>&ensp;&ensp;mongoDB的聚合框架模型建立在数据处理管道这一概念的基础之上。文档进入多阶段管道中，管道将文档转换为聚合结果。最基&ensp;&ensp;本的管道阶段类似于查询过滤器和修改输出文档形式的文档转换器。<br>&ensp;&ensp;其他的管道为分组和排序提供一些工具，可通过指定一个或多个字段完成分组或排序；同时提供了聚合数组内容的工具，操作的&ensp;&ensp;数组包括文档数组。另外，聚合阶段能够使用一些运算符，完成诸如计算均值或连接字符串之类的任务。<br>&ensp;&ensp;管道利用MongoDB本机的操作方法提供了有效的数据聚合操作，并且对于数据聚合来说采用本机的操作方法是首选的。<br>&ensp;&ensp;聚合管道支持在分片集合上执行操作。<br>&ensp;&ensp;数据还用之前聚合里面的这些</p>
<hr>
<p>&ensp;&ensp;db.collection.save({“name”:”s”,”sex”:”男”,”age”:1,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”a”,”sex”:”男”,”age”:2,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”d”,”sex”:”女”,”age”:3,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”g”,”sex”:”女”,”age”:1,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”h”,”sex”:”男”,”age”:1,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”k”,”sex”:”女”,”age”:1,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”p”,”sex”:”男”,”age”:1,”score”:600})<br>&ensp;&ensp;db.collection.save({“name”:”u”,”sex”:”女”,”age”:1,”score”:20})</p>
<hr>
<p>$project 对数据进行修改<br>db.collection.aggregate([{“$project”:{“name”:1,”score”:1}}])</p>
<hr>
<p><img src="project.png" alt="mongodb"></p>
<hr>
<p>$match 对数据进行过滤(如果是Number类型一定是数字不能是字符串)<br>db.collection.aggregate([{“$match”:{“score”:{“$gt”:100}}}])</p>
<hr>
<p><img src="match.png" alt="mongodb"></p>
<hr>
<p>$skip 对查询的数据跳过指定数量的文档，返回剩下数量的文档<br>首先查找scroe小于等于100的数据<br>db.collection.aggregate([{“$match”:{“score”:{“$lte”100}}}])</p>
<hr>
<p><img src="lte.png" alt="mongodb"></p>
<hr>
<p>然后跳过前三条的数据返回剩下的<br>db.collection.aggregate([{“$match”:{“score”:{“$lte”100}}},{“$skip”:3}])</p>
<hr>
<p><img src="lte.png" alt="mongodb"></p>
<hr>
<p>$limt 限制返回数据的条数<br>db.collection.aggregate([{“$match”:{“score”:{“$lte”:100}}},{“$limit”:3}])</p>
<hr>
<p><img src="match.png" alt="mongodb"></p>
<hr>
<p>$unwind 将数组里面中的每个值拆分为单独的文档<br>我们先在数据库里面插入下面的数据<br>db.collection.save({“name”:”ssx”,”age”:20,”firends”:[“A”,”B”,”C”]})<br>由于数据库有很多数据我们先找到我们方才插入的那一条 然后以firends分为单独的文档</p>
<hr>
<p><img src="unwind.png" alt="mongodb"></p>
<hr>
<p>$sort 可以根据任何字段（或者多个字段）进行排序，与在普通查询中的语法是相同的。如果要对大量的文档进行排序，强烈建议在管道的第一阶段进行排序，这时的排序操作可以使用索引。否则，排序过程就会比较慢，而且会占用大量内存。<br>1是升序，-1是降序<br>db.collection.find({}).sort({“score”:1})</p>
<hr>
<p><img src="all.png" alt="mongodb"></p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2017/03/23/mondodb聚合/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2017/03/23/mondodb聚合/" itemprop="url">mongodb聚合</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-23T14:27:35+08:00">
                2017-03-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="mongodb聚合"><a href="#mongodb聚合" class="headerlink" title="mongodb聚合"></a>mongodb聚合</h2><p>&ensp;&ensp;MongoDB中聚合(aggregate)主要用于处理数据(诸如统计平均值,求和等)，并返回计算后的数据结果。有点类似sql语句中的 count(*)。<br>基本语法为：db.collection.aggregate( [ &lt;stage1&gt;, &lt;stage2&gt;, … ] )<br>我们在数据库中插入一下文档：</p>
<hr>
<p>&ensp;&ensp;db.collection.save({“name”:”s”,”sex”:”男”,”age”:1,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”a”,”sex”:”男”,”age”:2,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”d”,”sex”:”女”,”age”:3,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”g”,”sex”:”女”,”age”:1,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”h”,”sex”:”男”,”age”:1,”score”:100})<br>&ensp;&ensp;db.collection.save({“name”:”k”,”sex”:”女”,”age”:1,”score”:100})</p>
<hr>
<p>&ensp;&ensp;执行下面的语句<br>db.collection.aggregate([{“$group”:{“_id”:”$sex”,”personCount”:{“$sum”:1}}}])<br>对性别sex进行分组并统计他们的数量</p>
<hr>
<p><img src="personcount.png" alt="mongodb"></p>
<hr>
<p>&ensp;&ensp;由于上面的数据看效果不是太明显 我们在插入两条数据<br>&ensp;&ensp;db.collection.save({“name”:”p”,”sex”:”男”,”age”:1,”score”:600})<br>&ensp;&ensp;db.collection.save({“name”:”u”,”sex”:”女”,”age”:1,”score”:20})<br>&ensp;&ensp;对性别进行分组然后对score进行求平均值 $avg<br>dv.collection.aggregate([“$group”:{“_id”:”$sex”,”scoreAvg”:{“$avg”:”$score”}}}])</p>
<hr>
<p><img src="scoreavg.png" alt="mongodb"></p>
<hr>
<p>&ensp;&ensp;对性别进行分组然后求最大值 $max<br>&ensp;&ensp;db.collection.aggregate([“$group”:{“_id”:”$sex”,”scoreMax”:{“$max”:”$score”}}])</p>
<hr>
<p><img src="scoreavg.png" alt="mongodb"></p>
<hr>
<p>&ensp;&ensp;对性别进行分组然后取最小值 $min<br>&ensp;&ensp;db.collection.aggregate([“$group”:{“_id”:”$sex”,”scoreMin”:{“$min”:”$score”}}])</p>
<hr>
<p><img src="scoreavg.png" alt="mongodb"></p>
<hr>
<p>&ensp;&ensp;对性别进行分组然后将score放进一个数组scores $push<br>&ensp;&ensp;db.collection.aggregate([“$group”:{“_id”:”$sex”,”scores”:{“$push”:”$score”}}])</p>
<hr>
<p><img src="push.png" alt="mongodb"></p>
<hr>
<p>对性别进行分组然后将score放进一个数组scores去掉重复的元素 $addToSet<br>db.collection.aggregate([“$group”:{“_id”:”$sex”,”scores”:{“$addToSet”:”$score”}}])</p>
<hr>
<p><img src="addtoset.png" alt="mongodb"></p>
<hr>
<p>根据资源文档的排序获取第一个元素 $first<br>db.collection.aggregate([“$group”:{“_id”:”$sex”,”firstelement”:{“$first”:”$score”}}])</p>
<hr>
<p><img src="firstelement.png" alt="mongodb"></p>
<hr>
<p>根据资源文档的排序获取最后一个元素 $last<br>db.collection.aggregate([“$group”:{“_id”:”$sex”,”lastelement”:{“$last”:”$score”}}])</p>
<hr>
<p><img src="last.png" alt="mongodb"></p>
<hr>
<p>全部统计不进行分组<br>db.collection.aggregate([“$group”:{“_id”:”null”,”totalScore”:{“$push”:”$score”}}])</p>
<hr>
<p><img src="all.png" alt="mongodb"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2017/01/10/关系型数据库和非关系型数据库的区别/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2017/01/10/关系型数据库和非关系型数据库的区别/" itemprop="url">关系型数据与非关系型数据库的区别</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-01-10T15:22:30+08:00">
                2017-01-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##关系型数据库<br>   1.表和表、表和字段、数据和数据存在着关系<br>   优点:<br>   1.数据之间有关系，进行数据的增删改查的时候是非常方便的<br>   2.关系型数据库是有事务操作的，保证数据的完整性和一致性。<br>   缺点：<br>   1.因为数据和数据是有关系的，底层是运行了大量的算法大量算法会降低系统的效率，会降低性能<br>   2.面对海量数据的增删改查的时候会显的无能为力<br>   3.海量数据对数据进行维护变得非常的无力<br>   非关系数据库<br>   为了处理海量数据，非关系数据库设计之初就是为了替代关系型数据库的关系<br>   优点：<br>   1.海量数据的增删改查是可以的<br>   2.海量数据的维护和处理非常轻松<br>  缺点：<br>   1.数据和数据没有关系，他们之间就是单独存在的<br>   2.非关系数据库没有关系，没有强大的事务关系，没有保证数据的完整性和安全性<br>   3.不支持多文档事务(mondodb4.0之前)<br>  适合处理海量数据，保证效率，不一定安全</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2015/08/10/h5新属性/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2015/08/10/h5新属性/" itemprop="url">h5新属性</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-10T15:22:30+08:00">
                2015-08-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##h5新增的属性<br>面试中经常被问，支支吾吾的老是答不全！！血泪教训，决定记下来！<br>h5是html的最新版本，是14年由w3c完成标准制定。增强了，浏览器的原生功能，减少浏览器插件（eg：flash）的应用，提高用户体验满意度，让开发更加方便。<br>h5新增的标签</p>
<hr>
<p><img src="newdata.png" alt="mongodb"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/sushengxi/sushengxi.git.io.git/sushengxi.git.io/2015/08/05/h5存储方式localStroage-sessionStroage/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="little su">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/sushengxi.git.io/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="little su的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/sushengxi.git.io/2015/08/05/h5存储方式localStroage-sessionStroage/" itemprop="url">h5存储方式localStroage和sessionStroage</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-08-05T15:22:30+08:00">
                2015-08-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##h5存储方式localStroage和sessionStroage<br>介绍h5的存储方式前先看一下cookie,localStroage,sessionStroage之间的区别</p>
<hr>
<p><img src="cookie.png" alt="mongodb"></p>
<hr>
<p>下面的截图是cookie的存取删除</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">//存入cookie</span><br><span class="line">function setCookie(name,value,days) &#123;</span><br><span class="line">  var exp = new Date();</span><br><span class="line">  exp.setTime(exp.getTime() + days*24*60*60*1000)</span><br><span class="line">  document.cookie = name+&quot;=&quot;+escape(value)+&quot;;expires=&quot;+exp.toGMTString();</span><br><span class="line">&#125;</span><br><span class="line">//获取cookie</span><br><span class="line">function getCookie(name) &#123;</span><br><span class="line">   var arr,reg=new RegExp(&quot;(^|)&quot;+name+&quot;=([^;]*)(:|$)&quot;);</span><br><span class="line">   if(arr = document.cookie.match(reg)) &#123;</span><br><span class="line">     return unescape(arr[2])</span><br><span class="line">   &#125; else &#123;</span><br><span class="line">   return null;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//获取coolie另一种方式</span><br><span class="line">function getCookie(key) &#123;</span><br><span class="line">  var arr1 = document.cookie.split(&quot;; &quot;);</span><br><span class="line">  for(var i = 0; i &lt; arr1.length;i++) &#123;</span><br><span class="line">    var arr2 = arr1[i].split(&quot;=&quot;);</span><br><span class="line">	if(arr2[0] == key) &#123;</span><br><span class="line">	  return unescape(arr1[1]);</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//删除cookie</span><br><span class="line">function delCookie(name) &#123;</span><br><span class="line">   var exp = new Date();</span><br><span class="line">   exp.setTime(exp.getTime()-1);</span><br><span class="line">   var cVal = getCookie(name);</span><br><span class="line">   if(cVal != null) &#123;</span><br><span class="line">     document.cookie = name+&quot;=&quot;+cVal+&quot;;expires=&quot;+exp.toGMTString();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>h5的存储方式localStorage,sessionStorage;<br>HTML5提供了在客户端存储数据的新方法，除IE7及以下不支持外，其他浏览器均支持。<br>简述：<br>localStorage - 没有时间限制的数据存储，只要用户不手动清除将会一直保留在本地；<br>sessionStorage - session会话期间的数据存储，关掉浏览器即被清除；<br>localStorage和sessionStorage都有以下几个方法：<br>1.存储数据<br>localStorage.setItem(“key”, “value”);//key为存储数据的键<br>或 localStorage.key=”value”;//类似于对象的操作方法</p>
<p>2.删除单个指定数据<br>localStorage.removeItem(“key”);</p>
<p>3.删除全部数据<br>localStorage.clear();<br>.想要改动某个存储的数据，直接用setItem覆写要改动的数据名下的数据就可以<br>4.获取本地存储的数据-查<br>var value=localStorage.getItem(“key”);//value即为所存的值<br>5.key()和length实现存储数据的遍历</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">little su</p>
              <p class="site-description motion-element" itemprop="description">h5，javascript,css,node,java,mysql,mongodb</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/sushengxi.git.io/archives/">
              
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">little su</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/sushengxi.git.io/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/sushengxi.git.io/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/sushengxi.git.io/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/sushengxi.git.io/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/sushengxi.git.io/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/sushengxi.git.io/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/sushengxi.git.io/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/sushengxi.git.io/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/sushengxi.git.io/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
